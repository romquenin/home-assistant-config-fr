function _templateObject4(){const a=_taggedTemplateLiteral(["\n      <style>\n        :host {\n          display: flex;\n          flex-direction: column;\n          flex: 1;\n        }\n        ha-card {\n          display: flex;\n          flex-direction: column;\n          flex: 1;\n          padding: 16px;\n          position: relative;\n        }\n        ha-card[more-info] {\n          cursor: pointer;\n        }\n        .flex {\n          display: flex;\n          display: -webkit-flex;\n          min-width: 0;\n        }\n        .justify {\n          justify-content: space-between;\n          -webkit-justify-content: space-between;\n        }\n        .header {\n          display: flex;\n          min-width: 0;\n          align-items: center;\n          position: relative;\n          opacity: .8;\n        }\n        .name {\n          font-size: 1.2rem;\n          font-weight: 500;\n          max-height: 1.4rem;\n          opacity: .75;\n        }\n        .icon {\n          display: inline-block;\n          position: relative;\n          flex: 0 0 40px;\n          width: 40px;\n          line-height: 40px;\n          text-align: center;\n          color: var(--paper-item-icon-color, #44739e);\n        }\n        .info {\n          margin: 1em 8px;\n          flex-wrap: wrap;\n          font-weight: 300;\n        }\n        .title[hide] .icon {\n          display: none;\n        }\n        .title[hide] .header {\n          margin-left: 8px;\n        }\n        #value {\n          font-size: 2.4em;\n          line-height: 1em;\n          display: inline-block;\n          margin-right: 4px;\n          max-size: 100%;\n        }\n        #measurement {\n          display: inline-block;\n          font-size: 1.4em;\n          font-weight: 400;\n          line-height: 1.2em;\n          margin-top: .1em;\n          vertical-align: bottom;\n          align-self: flex-end;\n          opacity: .6;\n        }\n        .graph {\n          align-self: flex-end;\n          margin: auto;\n          margin-bottom: 0px;\n          position: relative;\n          width: 100%;\n          display: flex;\n          flex-direction: row;\n          justify-content: space-between;\n        }\n        .graph > .svg {\n          align-self: flex-end;\n          margin: auto 8px;\n          flex: 1;\n        }\n        svg {\n          overflow: visible;\n        }\n        .label {\n          font-size: .8em;\n          display: flex;\n          flex-direction: column;\n          opacity: .5;\n          font-weight: 400;\n          justify-content: space-between;\n          margin-left: 8px;\n        }\n        .label--max {\n          align-self: flex-end;\n        }\n        .label--min {\n          align-self: flex-end;\n        }\n        .label--min:after,\n        .label--max:after {\n          content: ' -'\n        }\n        .ellipsis {\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n        }\n        ha-card[labels] .graph > .svg {\n          margin-left: 16px;\n        }\n      </style>"]);return _templateObject4=function(){return a},a}function _templateObject3(){const a=_taggedTemplateLiteral(["\n      <div class='label'>\n        <span class='label--max'>","</span>\n        <span class='label--min'>","</span>\n      </div>"]);return _templateObject3=function(){return a},a}function _templateObject2(){const a=_taggedTemplateLiteral(["\n      <svg width='100%' viewBox='0 0 500 ","'>\n        <path d="," fill='none' stroke=","\n          stroke-width="," stroke-linecap='round' stroke-linejoin='round' />\n      </svg>"]);return _templateObject2=function(){return a},a}function _templateObject(){const a=_taggedTemplateLiteral(["\n      ","\n      <ha-card\n        ?group=","\n        ?labels=","\n        ?more-info=","\n        style='font-size: ","px;'\n        @click='","'>\n        <div class='title flex' ?hide=",">\n          <div class='icon'>\n            <ha-icon .icon=","></ha-icon>\n          </div>\n          <div class='header'>\n            <span class='name ellipsis'>","</span>\n          </div>\n        </div>\n        <div class='info flex'>\n          <span id='value' class='ellipsis'>","</span>\n          <span id='measurement' class='ellipsis'>","</span>\n        </div>\n        <div class='graph'>\n          ","\n          <div class='svg'>\n            ","\n          </div>\n        </div>\n      </ha-card>"]);return _templateObject=function(){return a},a}function _taggedTemplateLiteral(a,b){return b||(b=a.slice(0)),Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}}))}function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){_defineProperty(a,b,c[b])})}return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}function _arrayWithHoles(a){if(Array.isArray(a))return a}!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b():"function"==typeof define&&define.amd?define(b):b()}(0,function(){"use strict";var k=Math.round,X=Math.floor,aa=Number.isNaN;function Q(b){let c=E.get(b.type);void 0===c&&(c=new Map,E.set(b.type,c));let d=c.get(b.strings);return void 0===d&&(d=new a(b,b.getTemplateElement()),c.set(b.strings,d)),d}function C(b,d){const c=b.element.content,e=b.parts,f=document.createTreeWalker(c,A,null,!1);let g=z(e),i=e[g],j=-1,k=0;const m=[];for(let a=null;f.nextNode();){j++;const b=f.currentNode;for(b.previousSibling===a&&(a=null),d.has(b)&&(m.push(b),null===a&&(a=b)),null!==a&&k++;void 0!==i&&i.index===j;)i.index=null===a?i.index-k:-1,i=e[g=z(e,g)]}m.forEach(a=>a.parentNode.removeChild(a))}const ba=new WeakMap,ca=a=>"function"==typeof a&&ba.has(a),da=void 0!==window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,ea=function(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null,f=b;for(;f!==c;){const b=f.nextSibling;a.insertBefore(f,d),f=b}},fa=function(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,d=b;for(;d!==c;){const b=d.nextSibling;a.removeChild(d),d=b}},e={},ga="{{lit-".concat((Math.random()+"").slice(2),"}}"),o="<!--".concat(ga,"-->"),ha=new RegExp("".concat(ga,"|").concat(o)),l=(()=>{const a=document.createElement("div");return a.setAttribute("style","{{bad value}}"),"{{bad value}}"!==a.getAttribute("style")})();class a{constructor(b,a){this.parts=[],this.element=a;let f=-1,c=0;const g=[],h=i=>{const e=i.content,a=document.createTreeWalker(e,133,null,!1);for(let j,k;a.nextNode();){f++,j=k;const i=k=a.currentNode;if(1===i.nodeType){if(i.hasAttributes()){const a=i.attributes;let e=0;for(let b=0;b<a.length;b++)0<=a[b].value.indexOf(ga)&&e++;for(;0<e--;){const e=b.strings[c],g=d.exec(e)[2],h=l&&"style"===g?"style$":/^[a-zA-Z-]*$/.test(g)?g:g.toLowerCase(),j=i.getAttribute(h).split(ha);this.parts.push({type:"attribute",index:f,name:g,strings:j}),i.removeAttribute(h),c+=j.length-1}}"TEMPLATE"===i.tagName&&h(i)}else if(3===i.nodeType){const b=i.nodeValue;if(0>b.indexOf(ga))continue;const d=i.parentNode,e=b.split(ha),a=e.length-1;c+=a;for(let b=0;b<a;b++)d.insertBefore(""===e[b]?r():document.createTextNode(e[b]),i),this.parts.push({type:"node",index:f++});d.insertBefore(""===e[a]?r():document.createTextNode(e[a]),i),g.push(i)}else if(8===i.nodeType)if(i.nodeValue===ga){const a=i.parentNode,b=i.previousSibling;null===b||b!==j||b.nodeType!==Node.TEXT_NODE?a.insertBefore(r(),i):f--,this.parts.push({type:"node",index:f++}),g.push(i),null===i.nextSibling?a.insertBefore(r(),i):f--,k=j,c++}else for(let a=-1;-1!==(a=i.nodeValue.indexOf(ga,a+1));)this.parts.push({type:"node",index:-1})}};h(a);for(const c of g)c.parentNode.removeChild(c)}}const c=a=>-1!==a.index,r=()=>document.createComment(""),d=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F \x09\x0a\x0c\x0d"'>=\/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;class h{constructor(a,b,c){this._parts=[],this.template=a,this.processor=b,this.options=c}update(a){let b=0;for(const c of this._parts)void 0!==c&&c.setValue(a[b]),b++;for(const b of this._parts)void 0!==b&&b.commit()}_clone(){const a=da?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),b=this.template.parts;let d=0,e=0;const f=a=>{const g=document.createTreeWalker(a,133,null,!1);for(let h=g.nextNode();d<b.length&&null!==h;){const a=b[d];if(!c(a))this._parts.push(void 0),d++;else if(e===a.index){if("node"===a.type){const a=this.processor.handleTextExpression(this.options);a.insertAfterNode(h),this._parts.push(a)}else this._parts.push(...this.processor.handleAttributeExpressions(h,a.name,a.strings,this.options));d++}else e++,"TEMPLATE"===h.nodeName&&f(h.content),h=g.nextNode()}};return f(a),da&&(document.adoptNode(a),customElements.upgrade(a)),a}}class m{constructor(a,b,c,d){this.strings=a,this.values=b,this.type=c,this.processor=d}getHTML(){const a=this.strings.length-1;let b="",c=!0;for(let e=0;e<a;e++){const a=this.strings[e];b+=a;const f=a.lastIndexOf(">");!(c=(-1<f||c)&&-1===a.indexOf("<",f+1))&&l&&(b=b.replace(d,(a,b,c,d)=>"style"===c?"".concat(b,"style$").concat(d):a)),b+=c?o:ga}return b+=this.strings[a]}getTemplateElement(){const a=document.createElement("template");return a.innerHTML=this.getHTML(),a}}class f extends m{getHTML(){return"<svg>".concat(super.getHTML(),"</svg>")}getTemplateElement(){const a=super.getTemplateElement(),b=a.content,c=b.firstChild;return b.removeChild(c),ea(b,c.firstChild),a}}const g=a=>null===a||"object"!=typeof a&&"function"!=typeof a;class p{constructor(a,b,c){this.dirty=!0,this.element=a,this.name=b,this.strings=c,this.parts=[];for(let d=0;d<c.length-1;d++)this.parts[d]=this._createPart()}_createPart(){return new i(this)}_getValue(){const a=this.strings,b=a.length-1;let c="";for(let d=0;d<b;d++){c+=a[d];const b=this.parts[d];if(void 0!==b){const a=b.value;if(null!=a&&(Array.isArray(a)||"string"!=typeof a&&a[Symbol.iterator]))for(const b of a)c+="string"==typeof b?b:b+"";else c+="string"==typeof a?a:a+""}}return c+=a[b]}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class i{constructor(a){this.value=void 0,this.committer=a}setValue(a){a===e||g(a)&&a===this.value||(this.value=a,ca(a)||(this.committer.dirty=!0))}commit(){for(;ca(this.value);){const a=this.value;this.value=e,a(this)}this.value!==e&&this.committer.commit()}}class u{constructor(a){this.value=void 0,this._pendingValue=void 0,this.options=a}appendInto(a){this.startNode=a.appendChild(r()),this.endNode=a.appendChild(r())}insertAfterNode(a){this.startNode=a,this.endNode=a.nextSibling}appendIntoPart(a){a._insert(this.startNode=r()),a._insert(this.endNode=r())}insertAfterPart(a){a._insert(this.startNode=r()),this.endNode=a.endNode,a.endNode=this.startNode}setValue(a){this._pendingValue=a}commit(){for(;ca(this._pendingValue);){const a=this._pendingValue;this._pendingValue=e,a(this)}const a=this._pendingValue;a!==e&&(g(a)?a!==this.value&&this._commitText(a):a instanceof m?this._commitTemplateResult(a):a instanceof Node?this._commitNode(a):Array.isArray(a)||a[Symbol.iterator]?this._commitIterable(a):void 0===a.then?this._commitText(a):this._commitPromise(a))}_insert(a){this.endNode.parentNode.insertBefore(a,this.endNode)}_commitNode(a){this.value!==a&&(this.clear(),this._insert(a),this.value=a)}_commitText(a){const b=this.startNode.nextSibling;a=null==a?"":a,b===this.endNode.previousSibling&&b.nodeType===Node.TEXT_NODE?b.textContent=a:this._commitNode(document.createTextNode("string"==typeof a?a:a+"")),this.value=a}_commitTemplateResult(a){const b=this.options.templateFactory(a);if(this.value&&this.value.template===b)this.value.update(a.values);else{const c=new h(b,a.processor,this.options),d=c._clone();c.update(a.values),this._commitNode(d),this.value=c}}_commitIterable(a){Array.isArray(this.value)||(this.value=[],this.clear());const b=this.value;let c,d=0;for(const e of a)void 0===(c=b[d])&&(c=new u(this.options),b.push(c),0==d?c.appendIntoPart(this):c.insertAfterPart(b[d-1])),c.setValue(e),c.commit(),d++;d<b.length&&(b.length=d,this.clear(c&&c.endNode))}_commitPromise(a){this.value=a,a.then(b=>{this.value===a&&(this.setValue(b),this.commit())})}clear(){let a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.startNode;fa(this.startNode.parentNode,a.nextSibling,this.endNode)}}class b{constructor(a,b,c){if(this.value=void 0,this._pendingValue=void 0,2!==c.length||""!==c[0]||""!==c[1])throw new Error("Boolean attributes can only contain a single expression");this.element=a,this.name=b,this.strings=c}setValue(a){this._pendingValue=a}commit(){for(;ca(this._pendingValue);){const a=this._pendingValue;this._pendingValue=e,a(this)}if(this._pendingValue!==e){const a=!!this._pendingValue;this.value!==a&&(a?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name)),this.value=a,this._pendingValue=e}}}class v extends p{constructor(a,b,c){super(a,b,c),this.single=2===c.length&&""===c[0]&&""===c[1]}_createPart(){return new n(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class n extends i{}let s=!1;try{const a={get capture(){return s=!0,!1}};window.addEventListener("test",a,a),window.removeEventListener("test",a,a)}catch(a){}class w{constructor(a,b,c){this.value=void 0,this._pendingValue=void 0,this.element=a,this.eventName=b,this.eventContext=c,this._boundHandleEvent=a=>this.handleEvent(a)}setValue(a){this._pendingValue=a}commit(){for(;ca(this._pendingValue);){const a=this._pendingValue;this._pendingValue=e,a(this)}if(this._pendingValue!==e){const a=this._pendingValue,b=this.value,c=null==a||null!=b&&(a.capture!==b.capture||a.once!==b.once||a.passive!==b.passive);c&&this.element.removeEventListener(this.eventName,this._boundHandleEvent,this._options),this._options=x(a),null!=a&&(null==b||c)&&this.element.addEventListener(this.eventName,this._boundHandleEvent,this._options),this.value=a,this._pendingValue=e}}handleEvent(a){"function"==typeof this.value?this.value.call(this.eventContext||this.element,a):this.value.handleEvent(a)}}const x=a=>a&&(s?{capture:a.capture,passive:a.passive,once:a.once}:a.capture),y=new class{handleAttributeExpressions(a,c,d,e){const f=c[0];return"."===f?new v(a,c.slice(1),d).parts:"@"===f?[new w(a,c.slice(1),e.eventContext)]:"?"===f?[new b(a,c.slice(1),d)]:new p(a,c,d).parts}handleTextExpression(a){return new u(a)}},E=new Map,M=new WeakMap,N=function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return new m(a,c,"html",y)},t=function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return new f(a,c,"svg",y)},A=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,O=a=>{let b=a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?0:1;for(const c=document.createTreeWalker(a,A,null,!1);c.nextNode();)b++;return b},z=function(a){let b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:-1;for(let d=b+1;d<a.length;d++){const b=a[d];if(c(b))return d}return-1},F=(a,b)=>"".concat(a,"--").concat(b);let P=!0;void 0===window.ShadyCSS?P=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected.Please update to at least @webcomponents/webcomponentsjs@2.0.2 and@webcomponents/shadycss@1.3.1."),P=!1);const T=["html","svg"],R=new Set,j=(a,b,c)=>{R.add(c);const d=a.querySelectorAll("style");if(0!==d.length){const f=document.createElement("style");for(let a=0;a<d.length;a++){const b=d[a];b.parentNode.removeChild(b),f.textContent+=b.textContent}if((a=>{T.forEach(b=>{const c=E.get(F(b,a));void 0!==c&&c.forEach(a=>{const b=a.element.content,c=new Set;Array.from(b.querySelectorAll("style")).forEach(a=>{c.add(a)}),C(a,c)})})})(c),function(a,b){let c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;const d=a.element.content,e=a.parts;if(null==c)return void d.appendChild(b);const f=document.createTreeWalker(d,A,null,!1);for(let d=z(e),g=0,h=-1;f.nextNode();)for(h++,f.currentNode===c&&(g=O(b),c.parentNode.insertBefore(b,c));-1!==d&&e[d].index===h;){if(0<g){for(;-1!==d;)e[d].index+=g,d=z(e,d);return}d=z(e,d)}}(b,f,b.element.content.firstChild),window.ShadyCSS.prepareTemplateStyles(b.element,c),window.ShadyCSS.nativeShadow){const c=b.element.content.querySelector("style");a.insertBefore(c.cloneNode(!0),a.firstChild)}else{b.element.content.insertBefore(f,b.element.content.firstChild);const a=new Set;a.add(f),C(b,a)}}},I=a=>null!==a,L=a=>a?"":null,B=(a,b)=>b!==a&&(b==b||a==a),q={attribute:!0,type:String,reflect:!1,hasChanged:B},G=new Promise(a=>a(!0)),U=1;class D extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=G,this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this._finalize();const a=[];for(const c of this._classProperties){var b=_slicedToArray(c,2);const d=b[0],e=b[1],f=this._attributeNameForProperty(d,e);void 0!==f&&(this._attributeToPropertyMap.set(f,d),a.push(f))}return a}static createProperty(a){let b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:q;if(!this.hasOwnProperty("_classProperties")){this._classProperties=new Map;const a=Object.getPrototypeOf(this)._classProperties;void 0!==a&&a.forEach((a,b)=>this._classProperties.set(b,a))}if(this._classProperties.set(a,b),this.prototype.hasOwnProperty(a))return;const c="symbol"==typeof a?Symbol():"__".concat(a);Object.defineProperty(this.prototype,a,{get(){return this[c]},set(d){const e=this[a];this[c]=d,this._requestPropertyUpdate(a,e,b)},configurable:!0,enumerable:!0})}static _finalize(){if(!(this.hasOwnProperty("_finalized")&&this._finalized)){const a=Object.getPrototypeOf(this);"function"==typeof a._finalize&&a._finalize(),this._finalized=!0,this._attributeToPropertyMap=new Map;const b=this.properties,c=[...Object.getOwnPropertyNames(b),...("function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(b):[])];for(const a of c)this.createProperty(a,b[a])}}static _attributeNameForProperty(a,b){const c=void 0!==b&&b.attribute;return!1===c?void 0:"string"==typeof c?c:"string"==typeof a?a.toLowerCase():void 0}static _valueHasChanged(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:B;return c(a,b)}static _propertyValueFromAttribute(a,b){const c=b&&b.type;if(void 0===c)return a;const d=c===Boolean?I:"function"==typeof c?c:c.fromAttribute;return d?d(a):a}static _propertyValueToAttribute(a,b){return void 0===b||void 0===b.reflect?void 0:(b.type===Boolean?L:b.type&&b.type.toAttribute||String)(a)}initialize(){this.renderRoot=this.createRenderRoot(),this._saveInstanceProperties()}_saveInstanceProperties(){for(const b of this.constructor._classProperties){var a=_slicedToArray(b,1);const c=a[0];if(this.hasOwnProperty(c)){const a=this[c];delete this[c],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(c,a)}}}_applyInstanceProperties(){for(const b of this._instanceProperties){var a=_slicedToArray(b,2);const c=a[0],d=a[1];this[c]=d}this._instanceProperties=void 0}createRenderRoot(){return this.attachShadow({mode:"open"})}connectedCallback(){this._updateState&U?void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this):this.requestUpdate()}disconnectedCallback(){}attributeChangedCallback(a,b,c){b!==c&&this._attributeToProperty(a,c)}_propertyToAttribute(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:q;const d=this.constructor,f=d._propertyValueToAttribute(b,c);if(void 0!==f){const b=d._attributeNameForProperty(a,c);void 0!==b&&(this._updateState|=8,null===f?this.removeAttribute(b):this.setAttribute(b,f),this._updateState&=-9)}}_attributeToProperty(a,b){if(!(this._updateState&8)){const c=this.constructor,d=c._attributeToPropertyMap.get(a);if(void 0!==d){const a=c._classProperties.get(d);this[d]=c._propertyValueFromAttribute(b,a)}}}requestUpdate(a,b){if(void 0!==a){const c=this.constructor._classProperties.get(a)||q;return this._requestPropertyUpdate(a,b,c)}return this._invalidate()}_requestPropertyUpdate(a,b,c){return this.constructor._valueHasChanged(this[a],b,c.hasChanged)?(this._changedProperties.has(a)||this._changedProperties.set(a,b),!0===c.reflect&&(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(a,c)),this._invalidate()):this.updateComplete}async _invalidate(){if(!this._hasRequestedUpdate){let a;this._updateState|=4;const b=this._updatePromise;this._updatePromise=new Promise(b=>a=b),await b,this._validate(),a(!this._hasRequestedUpdate)}return this.updateComplete}get _hasRequestedUpdate(){return this._updateState&4}_validate(){if(this._instanceProperties&&this._applyInstanceProperties(),this.shouldUpdate(this._changedProperties)){const a=this._changedProperties;this.update(a),this._markUpdated(),this._updateState&U||(this._updateState|=1,this.firstUpdated(a)),this.updated(a)}else this._markUpdated()}_markUpdated(){this._changedProperties=new Map,this._updateState&=-5}get updateComplete(){return this._updatePromise}shouldUpdate(){return!0}update(){if(void 0!==this._reflectingProperties&&0<this._reflectingProperties.size){for(const b of this._reflectingProperties){var a=_slicedToArray(b,2);const c=a[0],d=a[1];this._propertyToAttribute(c,this[c],d)}this._reflectingProperties=void 0}}updated(){}firstUpdated(){}}D._attributeToPropertyMap=new Map,D._finalized=!0,D._classProperties=new Map,D.properties={};class V extends D{update(a){super.update(a);const b=this.render();b instanceof m&&this.constructor.render(b,this.renderRoot,{scopeName:this.localName,eventContext:this})}render(){}}V.render=(b,c,d)=>{const e=d.scopeName,f=M.has(c);if(((a,b,c)=>{let d=M.get(b);void 0===d&&(fa(b,b.firstChild),M.set(b,d=new u(Object.assign({templateFactory:Q},c))),d.appendInto(b)),d.setValue(a),d.commit()})(b,c,Object.assign({templateFactory:(b=>c=>{const d=F(c.type,b);let e=E.get(d);void 0===e&&(e=new Map,E.set(d,e));let f=e.get(c.strings);if(void 0===f){const d=c.getTemplateElement();P&&window.ShadyCSS.prepareTemplateDom(d,b),f=new a(c,d),e.set(c.strings,f)}return f})(e)},d)),c instanceof ShadowRoot&&P&&b instanceof m){if(!R.has(e)){const a=M.get(c).value;j(c,a.template,e)}f||window.ShadyCSS.styleElement(c.host)}};class J{constructor(a,b,c){this.width=a-2*c,this.height=b-4*c,this.margin=c,this.min=null,this.max=null}coordinates(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;a=a.filter(a=>!aa(+a.state)),this.min=Math.min.apply(Math,a.map(a=>+a.state)),this.max=Math.max.apply(Math,a.map(a=>+a.state));const d=new Date().getTime(),f=function(a,c){let e=!!(2<arguments.length&&arguments[2]!==void 0)&&arguments[2];const f=d-new Date(c.last_changed).getTime();let g=Math.abs(f/36e5-b);return e?(g=60*(g-X(g)),g=(10*k(g/10)).toString()[0]):g=X(g),a[g]||(a[g]=[]),a[g].push(c),a};return a=a.reduce((a,b)=>f(a,b),[]),1<c&&(a=a.map(a=>a.reduce((a,b)=>f(a,b,!0),[]))),this._calcCoords(a,b,c)}_calcCoords(a,b){var d=this;let f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;const g=[];let j=this.width/(b-(1===f?1:0));j=isFinite(j)?j:this.width;const k=(this.max-this.min)/this.height,c=function(b,f){let e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1;if(1<m)return b.forEach((a,b)=>c(a,f,b,m-1));let a=b.reduce((a,b)=>a+parseFloat(b.state),0)/b.length;const i=j*(f+e/6)+d.margin,h=d.height-(a-d.min)/k+2*d.margin;g.push([i,h])};return a.forEach((a,b)=>c(a,b,0,f)),1===g.length&&(g[1]=[this.width+this.margin,g[0][1]]),g.push([this.width+this.margin,g[g.length-1][1]]),g}getPath(a){let b,c,d="",f=a.filter(Boolean)[0];return d+="M ".concat(f[0],",").concat(f[1]),a.forEach(a=>{b=a,c=this._midPoint(f[0],f[1],b[0],b[1]),d+=" ".concat(c[0],",").concat(c[1]),d+=" Q".concat(b[0],",").concat(b[1]),f=b}),d+=" ".concat(b[0],",").concat(b[1])}_midPoint(a,b,c,d){return[(a-c)/2+c,(b-d)/2+d]}}const K=14,W={humidity:"hass:water-percent",illuminance:"hass:brightness-5",temperature:"hass:thermometer",battery:"hass:battery"};customElements.define("mini-graph-card",class extends V{constructor(){super()}createRenderRoot(){return this}set hass(a){this._hass=a;const b=a.states[this.config.entity];b&&this.entity!==b&&(this.entity=b,this.getHistory())}static get properties(){return{_hass:{},config:{},entity:{},Graph:{},line:String}}setConfig(a){if(!a.entity||"sensor"!==a.entity.split(".")[0])throw new Error("Specify an entity from within the sensor domain.");this.style="display: flex; flex-direction: column;";const b=_objectSpread({decimals:null,detail:1,font_size:K,height:100,hours_to_show:24,icon:!1,hide_icon:!1,labels:!1,line_color:"var(--accent-color)",line_width:5,more_info:!0},a);b.font_size=a.font_size/100*K||K,b.hours_to_show=X(+b.hours_to_show)||24,b.height=+b.height,b.line_width=+b.line_width,b.detail=1===b.detail||2===b.detail?b.detail:1,this.Graph||(this.Graph=new J(500,b.height,b.line_width)),this.config=b}async getHistory(){let a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this,b=a.config;const c=new Date,d=new Date;d.setHours(c.getHours()-b.hours_to_show);const e=await this.fetchRecent(b.entity,d,c);if(!(1>e[0].length)){const a=this.Graph.coordinates(e[0],b.hours_to_show,b.detail);this.line=this.Graph.getPath(a)}}shouldUpdate(a){return a.has("entity")||a.has("line")}render(){let a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this,b=a.config,c=a.entity;return N(_templateObject(),this._style(),b.group,b.labels,b.more_info,b.font_size,()=>this.handleMore(),b.hide_icon,this.computeIcon(c),this.computeName(c),this.computeState(),this.computeUom(c),b.labels?this.renderLabels():"",this.line?this.renderGraph():"")}renderGraph(){return t(_templateObject2(),this.config.height,this.line,this.computeColor(),this.config.line_width)}renderLabels(){return N(_templateObject3(),this.Graph.max,this.Graph.min)}handleMore(){let a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this,b=a.config;b.more_info&&this.fire("hass-more-info",{entityId:b.entity})}fire(a,b,c){c=c||{},b=null==b?{}:b;const d=new Event(a,{bubbles:void 0===c.bubbles||c.bubbles,cancelable:!!c.cancelable,composed:void 0===c.composed||c.composed});return d.detail=b,this.dispatchEvent(d),d}computeColor(){const a=+this.entity.state||0,b=this.config.line_value_above,c=this.config.line_value_below;return null!==b&&a>b?this.config.line_color_above:null!==c&&a<c?this.config.line_color_below:this.config.line_color}computeName(){return this.config.name||this.entity.attributes.friendly_name}computeIcon(){return this.config.icon||this.entity.attributes.icon||W[this.entity.attributes.device_class]||W.temperature}computeUom(){return this.config.unit||this.entity.attributes.unit_of_measurement||""}computeState(){const a=this.config.decimals;if(null===a||isNaN(a)||aa(this.entity.state))return this.entity.state;const b=Math.pow(10,a);return(k(this.entity.state*b)/b).toFixed(a)}async fetchRecent(a,b,c){let d="history/period";return b&&(d+="/".concat(b.toISOString())),d+="?filter_entity_id=".concat(a),c&&(d+="&end_time=".concat(c.toISOString())),await this._hass.callApi("GET",d)}_style(){return N(_templateObject4())}getCardSize(){return 3}})});
